---
layout: post
title: "CS231n Chapter 11 - Detection and Segmentation"
description: "Notes"
categories: [CS231n]
tags: [Python]
redirect_from:
  - /2019/08/05/
---

# CS231n Chapter 11 - Detection and Segmentation    

## Introduction  

之前我们所讨论的所有图像处理领域的问题都仅仅是图像分类，但是在计算机视觉领域，还有多种其他类型的问题，比如图像细分segmentation，定位localization，检测detection。这些任务都会使用计算机视觉和卷积神经网络。  

## Semantic Segmentation  

语义分割的意义是让计算机能够正确的对图像中的不同物体进行分类。那么我们可能会想到的方式是用label的方式对图像中可能存在的物体进行标注，然后依次对每一个像素进行检测，但是这种方法会导致计算的负担相当大，此外对于每个像素内的重叠特征无法很好的检测到，所以鉴于性能和复杂度都不能令人满意，我们不选择这种方法。  

那么我们进而会想到，与其单独提取特征，我们不如将整个图片导入一个完全的卷积神经网络，在每个卷积层之间并没有完全连接层，也就是整个网络都是卷积层，从课程PPT上我甚至没有找到池化层，那么这么一个完全的神经网络可以输出一个C×H×W的张量，C即是我们感兴趣的label数量，这样我们可以一次性的得到输入图像中的每一个位置的loss。  

在整个完全卷积网络的运行中，我们会对其进行下采样和上采样，先将输入的规模缩小为mid规模，一般是H/2和W/2，然后经过一部分处理后再将其缩小为H/4和W/4，然后再经过一部分处理后再用两段上采样将其放大为原来大小。这里牵扯到上采样和下采样，这里是我找的一篇比较好的博客：[链接](https://blog.csdn.net/stf1065716904/article/details/78450997)，课程中也进行了一些介绍，对于上采样，主要采取unpooling的方式，这里有两种具体的方式，比如复制原有的值，让新的部分区域全部是该值；另一种方式是用0来填充放大后的其他位置，这里有一个tip，我们需要保证下采样和上采样相互对应，即在pooling的时候我们要记住该区域内最大的位置，也就是保留的数值的具体位置，当上采样的时候我们将原数据保留在这个具体位置上，然后用0来填充其他值。  

上面介绍了池化的转置，这里介绍卷积的转置，卷积的转置其实就是类似于卷积的反操作，具体的操作方式是将我们的输入，也就是卷积操作后的值的每一个位置拎出来，那么每一个被拎出来的值都是通过卷积操作得出的，我们的操作是将其周围全部补0，然后与卷积核kerneo进行卷积运算，得到的结果就是转置卷积的值。那么考虑一下尺寸，假设输入是2×2，扩大后的输入是5×5，卷积核为3×3，那么得到的结果是3×3，那么卷积操作是将4×4的输入变成了2×2，而这里反卷积却是将2×2变成了3×3，可以看出卷积和反卷积无论数值还是尺寸，都不是完全互逆的，这也是卷积转置不等于信号处理领域的反卷积的原因之一。  

这里还用了一维的卷积和卷积转置操作作为示例，解释了卷积操作实质就是矩阵乘法，转置卷积其实就是矩阵转置后的乘法。  

## Classifiation+Localization  

接下来是定位问题，定位问题一般和分类问题一起进行，可以在图像中识别并标记出物体的位置。同样，我们首先可以考虑用回归问题的思想来解决这个问题，首先用分类的思想和框架来解决分类问题，之后在卷积层之后再加一个FC层用于定位框的定位，输出中心的位置和框的长宽，这里我们会有两个loss，一个是分类的softmax loss，另一个是位置的correct loss，衡量边界框坐标的正确性，之后我们将两个损失加权得到总损失。这种方式的缺点是由于两个损失函数加权得到最后的损失函数，所以我们的超参数实际上很难选取，很难找到一堆同时符合两个损失函数收敛的超参数。那么这时候就自然产生了一个疑问:为什么要用一组超参数呢？为什么不对每一个损失函数都用不同的一批超参数呢？这里的回答是其实我们也会这么做，就想进行迁移学习一样，可以分别训练两个不同的网络，然后对整体进行微调，那么我感觉这其实就是两组不同的超参数了，我还是有些糊涂的。  

这里举了一个人类姿态估计的例子，用十四个预测点来决定一个人的姿态情况，我们应用上述框架就可以很好的完成这个任务。  

## Object Detection  

最后介绍的是物体检测。物体检测和之前的分类定位的不同之处是这里我们要检测的物体数量是不确定的，所以我们不能简单的使用回归框架，将探测问题简单的分成分类+定位两个问题来解决。

---
本博客支持disqus实时评论功能，如有错误或者建议，欢迎在下方评论区提出，共同探讨。  
